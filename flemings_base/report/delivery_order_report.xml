<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <!-- Delivery Order Report -->
        <template id="report_fg_delivery_order_document">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="flemings_base.report_fg_delivery_order_custom_layout">
                        <div class="page" style="font-family:sans-serif !important; font-size: 10pt; margin-left: 10px !important; margin-right: 10px !important;">

                            <style>
                                td {word-break: break-word !important; word-spacing: 3px !important; padding:5px; page-break-inside: avoid !important;}

                                .non-border, .non-border > tr, .non-border > tr > td {
                                    border: none !important; border-color: #ffffff !important;
                                }
                            </style>

                            <t t-if="o and 'company_id' in o">
                                <t t-set="company" t-value="o.company_id.sudo()"/>
                            </t>
                            <t t-if="not o or not 'company_id' in o">
                                <t t-set="company" t-value="res_company"/>
                            </t>

                            <table width="100%" class="non-border" cellpadding="0px" cellspacing="0px" style="font-family:sans-serif !important; font-size:10pt; padding:5px;">
                                <thead>
                                    <tr>
                                        <td style="width:5%; padding:5px; border-bottom:1px solid black; font-weight:bold; text-align:left;">S/N</td>
                                        <td style="width:65%; padding:5px; border-bottom:1px solid black; font-weight:bold; text-align:left;">Product Code / Description</td>
                                        <td style="width:13%; padding:5px; border-bottom:1px solid black; font-weight:bold; text-align:right;">Qty</td>
                                        <td style="width:17%; padding:5px; border-bottom:1px solid black; font-weight:bold; text-align:center;">UOM</td>
                                    </tr>
                                </thead>

                                <t t-set="fg_sno" t-value="1"/>
                                <t t-foreach="o.move_line_ids_without_package" t-as="line">
                                    <tr>
                                        <td style="width:5%; padding:5px; text-align:left;">
                                            <span t-esc="fg_sno"/>
                                            <t t-set="fg_sno" t-value="fg_sno+1"/>
                                        </td>
                                        <td style="width:65%; padding:5px; text-align:left;">
                                            <span t-field="line.product_id.default_code"/><br/>
                                            <span t-field="line.product_id.description_sale"/>
                                        </td>
                                        <td style="width:13%; padding:5px; text-align:right;">
                                            <span t-esc="'{0:,.0f}'.format(line.qty_done)"/>
                                        </td>
                                        <td style="width:17%; padding:5px; text-align:center;">
                                            <span t-field="line.product_uom_id"/>
                                        </td>
                                    </tr>
                                </t>
                            </table>

                            <table width="100%" class="non-border" cellpadding="0px" cellspacing="0px" style="font-family:sans-serif !important; font-size:10pt; padding:5px;">
                                <tr>
                                    <td style="width:53%; padding:5px; border-top:1px solid black; text-decoration:underline;">Remarks</td>
                                    <td rowspan="3" style="width:13%; padding:5px; border-top:1px solid black; text-align:right;">Total Quantity:</td>
                                    <td rowspan="3" style="width:17%; padding:5px; border-top:1px solid black; text-align:right; font-weight:bold;">
                                        <span t-esc="'{0:,.0f}'.format(sum(o.move_line_ids_without_package.mapped('qty_done')))"/>
                                    </td>
                                    <td rowspan="3" style="width:17%; padding:5px; border-top:1px solid black;"/>
                                </tr>
                                <tr>
                                    <td style="width:53%; padding:5px;">
                                        <span t-field="o.fg_remarks"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width:53%; border-top:1px dashed black; border-bottom:1px dashed black; outline-offset:-2px;"/>
                                </tr>
                            </table>

                        </div>
                    </t>
                </t>
            </t>
        </template>

        <record id="paperformat_fg_delivery_order_report" model="report.paperformat">
            <field name="name">Flemings Delivery Order</field>
            <field name="default" eval="True"/>
            <field name="format">A4</field>
            <field name="page_height">0</field>
            <field name="page_width">0</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">103</field>
            <field name="margin_bottom">10</field>
            <field name="margin_left">8</field>
            <field name="margin_right">8</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">98</field>
            <field name="dpi">80</field>
        </record>

        <record id="report_fg_delivery_order" model="ir.actions.report">
            <field name="name">Delivery Order</field>
            <field name="model">stock.picking</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">flemings_base.report_fg_delivery_order_document</field>
            <field name="report_file">flemings_base.report_fg_delivery_order_document</field>
            <field name="binding_type">report</field>
            <field name="binding_model_id" ref="flemings_base.model_stock_picking"/>
            <field name="paperformat_id" ref="paperformat_fg_delivery_order_report"/>
            <field name="print_report_name">'Delivery Order - %s' % (object.name or '').replace('/','_')</field>
        </record>

        <!-- Delivery Order Report - Header Layout -->
        <template id="report_fg_delivery_order_custom_header_layout">
            <div class="header">
                <style>
                    td {word-break: break-word !important; word-spacing: 3px !important; padding:5px; page-break-inside: avoid !important;}

                    .non-border, .non-border > tr, .non-border > tr > td {
                        border: none !important; border-color: #ffffff !important;
                    }
                </style>

                <table width="100%" class="non-border" cellpadding="0px" cellspacing="0px" style="font-family:sans-serif !important; font-size:10pt; padding:5px;">
                    <thead>
                        <tr>
                            <td style="width:25%; text-align:left; padding-left:6px;">
                                <img t-att-src="image_data_uri(company.logo)" alt="Logo" style="width:200px; float:left !important"/>
                            </td>
                            <td style="width:50%; text-align:left;">
                                <div style="width:auto; padding-left:15px; font-size:12pt; float:left">
                                    <div t-field="company.name" t-attf-style="float:left; color:#000000; white-space:nowrap; font-size:14pt; font-weight:bold; padding-right:4px;"/>
                                    <p style="margin-bottom:0px; padding-top:0px; text-align:left">
                                        <span t-if="company.street or company.street2">
                                            <br/>
                                            <span t-if="company.street">
                                                <span t-field="company.street"/>
                                            </span>
                                            <span t-if="company.street2">,
                                                <span t-field="company.street2"/>
                                            </span>
                                            <br/>
                                        </span>

                                        <span t-if="company.country_id">
                                            <span t-field="company.country_id.name"/>
                                        </span>
                                        <span t-if="company.zip">
                                            ,
                                            <span t-field="company.zip"/>
                                        </span>
                                        <span t-if="company.phone">Tel:
                                            <span t-field="company.phone"/>
                                        </span>
                                        <span t-if="company.vat">Fax:
                                            <span t-field="company.fax"/>
                                        </span>
                                        <br/>

                                        <span t-if="company.email">Email:
                                            <span t-field="company.email"/>
                                        </span>
                                        <span t-if="company.website">
                                            <span t-field="company.website"/>
                                        </span>
                                    </p>
                                </div>
                            </td>
                            <td style="width:25%; text-align:right; padding-right:6px;">
                                <img t-att-src="image_data_uri(company.logo)" alt="Logo" style="width:200px; float:left !important"/>
                            </td>
                            </tr>
                        <tr>
                            <td colspan="3" style="width:100%; border-bottom: 1px solid black; padding:5px;">
                                <table width="100%" class="non-border" cellpadding="0px" cellspacing="0px" style="font-family:sans-serif !important; font-size:10pt; padding:5px;">
                                    <tr style="height:6px;"/>
                                    <tr>
                                        <td style="width:64%; text-align:left; border-top:1px solid black; vertical-align:top !important;">
                                            <table width="100%" class="non-border" cellpadding="0px" cellspacing="0px" style="font-family:sans-serif !important; font-size:10pt; padding:5px;">
                                                <tr>
                                                    <td>Deliver To: </td>
                                                </tr>
                                                <tr>
                                                    <td><span t-field="o.partner_id"/></td>
                                                </tr>
                                                <tr>
                                                    <td><span t-field="o.partner_id.street"/></td>
                                                </tr>
                                                <t t-if="o.partner_id.street2">
                                                    <tr>
                                                        <td><span t-field="o.partner_id.street2"/></td>
                                                    </tr>
                                                </t>
                                                <t t-if="o.partner_id.country_id and o.partner_id.country_id.code != 'SG'">
                                                    <td>
                                                        <span t-field="o.partner_id.city"/>
                                                        <t t-if="o.partner_id.city and o.partner_id.state_id">,&#160;</t>
                                                        <span t-field="o.partner_id.state_id"/>
                                                    </td>
                                                </t>
                                                <tr>
                                                    <td><span t-field="o.partner_id.country_id"/> <span t-field="o.partner_id.zip"/></td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td style="width:36%; text-align:left; border-top:1px solid black; vertical-align:top !important;">
                                            <table width="100%" class="non-border" cellpadding="0px" cellspacing="0px" style="font-family:sans-serif !important; font-size:10pt; padding:5px;">
                                                <tr>
                                                    <td colspan="2" style="width:100%; text-align:center; font-size:15pt;"><strong>DELIVERY ORDER</strong></td>
                                                </tr>
                                                <tr>
                                                    <td style="width:44%;">Delivery Order No.</td>
                                                    <td style="width:56%;">: <span t-field="o.name"/></td>
                                                </tr>
                                                <tr>
                                                    <td style="width:44%;">Sales Order No.</td>
                                                    <td style="width:56%;">: <span t-field="o.sale_id"/></td>
                                                </tr>
                                                <tr>
                                                    <td style="width:44%;">Delivery Date</td>
                                                    <td style="width:56%;">: <span t-field="o.scheduled_date" t-options='{"widget": "date", "format": "dd MMM yyyy"}'/></td>
                                                </tr>
                                                <tr>
                                                    <td style="width:44%;">Payment Term</td>
                                                    <td style="width:56%;">:
                                                        <span t-field="o.sale_id.payment_term_id"/>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="width:44%;">Salesperson</td>
                                                    <td style="width:56%;">: <span t-field="o.user_id"/></td>
                                                </tr>
                                                <tr>
                                                    <td style="width:44%;">Process By</td>
                                                    <td style="width:56%;">:
                                                        <span t-field="o.customer_service_id"/>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="width:44%;">Purchase Order No.</td>
                                                    <td style="width:56%;">: <span t-field="o.fg_purchase_order_no"/></td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:64%; text-align:left;">
                                            ATTN : <span t-field="o.user_id"/>
                                        </td>
                                        <td rowspan="3" style="width:36%; text-align:left;">
                                            <table width="100%" class="non-border" cellpadding="0px" cellspacing="0px" style="font-family:sans-serif !important; font-size:10pt; padding:5px;">
                                                <tr>
                                                    <td style="width:45%;">Country</td>
                                                    <td style="width:55%;">: <span t-field="o.partner_id.country_id"/></td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:64%; text-align:left;">
                                            Tel: <span t-field="company.phone"/>
                                            Fax: <span t-field="company.fax"/>
                                            Mob: <span t-field="company.mobile"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width:64%; text-align:left;">
                                            Email: <span t-field="company.email"/>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </thead>
                </table>

                <div class="last-page" style="margin-bottom: 5px; position: absolute; top: 1170px; width: 100%; padding-right: 47px; page-break-before:always !important;">
                	<div class="row">
                        <div class="col-4" style="padding-right: 0; font-size:9pt !important;">
	                        <div style="height:10px;"/>
	                        <div style="padding:5px; text-align:center; font-size: 12pt; word-spacing: 2px !important;">
	                            <strong>Received in good order &amp; condition by</strong>
	                        </div>
	                        <div style="height:100px;">
                                <t t-if="docs.signature">
                                    <img t-att-src="image_data_uri(docs.signature)" style="max-height: 4cm; max-width: 8cm;"/>
                                </t>
                            </div>
	                        <div class="font-italic" style="border-top:1px solid black; padding:5px; text-align:center; line-height: 15px; font-size:9pt !important; word-spacing: 2px !important;">
                                Signature &amp; Company Stamp
	                        </div>
	                    </div>
	                    <div class="col-4" style="padding-right: 0; font-size:9pt !important;">
	                        <p style="height:180px;"/>
	                    </div>
	                    <div class="col-4" style="padding-left: 10px;">
	                        <div style="height:10px;"/>
	                        <div style="padding:5px; text-align:center; font-size: 12pt; word-spacing: 2px !important;">
	                            <strong>Authorisation</strong>
	                        </div>
	                        <div style="height:100px;"/>
	                        <div class="font-italic" style="border-top:1px solid black; padding:5px; text-align:center; line-height: 15px; font-size:9pt !important; word-spacing: 2px !important;">
                                For <span t-field="company.name"/>
	                        </div>
	                    </div>
	            	</div>
	            </div>
            </div>
        </template>

		<!-- Delivery Order Report - Footer Layout	-->
		<template id="report_fg_delivery_order_custom_footer_layout">
            <div class="footer">
                <style>
                    td {word-break: break-word !important; word-spacing: 3px !important; page-break-inside: avoid !important;}

                    .non-border, .non-border > tr, .non-border > tr > td {
                        border: none !important; border-color: #ffffff !important;
                    }
                </style>

                <table width="100%" class="non-border" cellpadding="0px" cellspacing="0px" style="font-family:sans-serif !important; font-size:10pt; padding:5px;">
                    <thead>
                        <tr>
                            <td style="width:66%; text-align:left; border-top:1px solid black; vertical-align:middle !important;">
                                Print By: <span t-esc="user.name"/> /
                                <span t-esc="context_timestamp(datetime.datetime.now()).strftime('%d-%b-%y %I:%M:%S %p')"/>
                            </td>
                            <td style="width:34%; text-align:right; border-top:1px solid black; vertical-align:middle !important;">
                                Page <span class="page"/> of <span class="topage"/>
                            </td>
                        </tr>
                    </thead>
                </table>
            </div>
        </template>

		<!-- Delivery Order Report - Layout Call -->
		<template id="report_fg_delivery_order_custom_layout">
            <t t-if="o and 'company_id' in o">
                <t t-set="company" t-value="o.company_id.sudo()"/>
            </t>
            <t t-if="not o or not 'company_id' in o">
                <t t-set="company" t-value="res_company"/>
            </t>
            <div class="article">
                <t t-call="flemings_base.report_fg_delivery_order_custom_header_layout"/>
                <t t-out="0"/>
                <t t-call="flemings_base.report_fg_delivery_order_custom_footer_layout"/>
            </div>
        </template>

        <!-- Hide Default 'Delivery Slip' Report -->
        <record id="stock.action_report_delivery" model="ir.actions.report">
            <field name="binding_model_id" eval="False"/>
        </record>

    </data>
</odoo>

